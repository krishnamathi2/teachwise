(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[997],{3454:function(e,t,r){"use strict";var n,s;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"===typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(7663)},7057:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/credits-test",function(){return r(87)}])},87:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(7568),s=r(797),i=r(7582),c=r(5893),a=r(7294),o=(0,r(2830).eI)("https://fnbmngpucvahupgyxzre.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZuYm1uZ3B1Y3ZhaHVwZ3l4enJlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA5NjY1MDQsImV4cCI6MjA3NjU0MjUwNH0.xOP4I9ysM3XkPQZvnD63iXf79sHhhrakaCBoR1-8T9E");function u(){var e=(0,a.useState)(null),t=e[0],r=e[1],u=(0,a.useState)(0),l=u[0],d=u[1],h=(0,a.useState)(!0),f=h[0],m=h[1],p=(0,a.useState)([]),x=p[0],b=p[1];(0,a.useEffect)((function(){g()}),[]);var g=function(){var e=(0,n.Z)((function(){var e,t,n;return(0,i.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),[4,o.auth.getUser()];case 1:return e=s.sent(),t=e.data.user,r(t),t?[4,v(t.id)]:[3,3];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:return n=s.sent(),console.error("Error checking user:",n),[3,5];case 5:return m(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=(0,n.Z)((function(e){var t,r;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch("/api/credits/balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e})})];case 1:return[4,n.sent().json()];case 2:return t=n.sent(),d(t.credits||0),w("\u2705 Credits API working","Current credits: ".concat(t.credits)),[3,4];case 3:return r=n.sent(),w("\u274c Credits API failed",r.message),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,n.Z)((function(){var e,r;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:if(!t)return[2];n.label=1;case 1:return n.trys.push([1,7,,8]),[4,fetch("/api/credits/deduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.id,amount:5,operation:"test_deduction",description:"Test credit deduction"})})];case 2:return[4,n.sent().json()];case 3:return(e=n.sent()).success?(w("\u2705 Credit deduction working","Deducted 5 credits"),[4,v(t.id)]):[3,5];case 4:return n.sent(),[3,6];case 5:w("\u274c Credit deduction failed",e.message),n.label=6;case 6:return[3,8];case 7:return r=n.sent(),w("\u274c Credit deduction error",r.message),[3,8];case 8:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),j=function(){var e=(0,n.Z)((function(){var e,r;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:if(!t)return[2];n.label=1;case 1:return n.trys.push([1,7,,8]),[4,fetch("/api/credits/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.id,amount:50,type:"bonus",description:"Test credit bonus"})})];case 2:return[4,n.sent().json()];case 3:return(e=n.sent()).success?(w("\u2705 Credit addition working","Added 50 credits"),[4,v(t.id)]):[3,5];case 4:return n.sent(),[3,6];case 5:w("\u274c Credit addition failed",e.message),n.label=6;case 6:return[3,8];case 7:return r=n.sent(),w("\u274c Credit addition error",r.message),[3,8];case 8:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),w=function(e,t){b((function(r){return(0,s.Z)(r).concat([{title:e,message:t,timestamp:(new Date).toLocaleTimeString()}])}))};return f?(0,c.jsx)("div",{className:"p-8",children:"Loading..."}):t?(0,c.jsxs)("div",{className:"p-8 max-w-4xl mx-auto",children:[(0,c.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Credits System Test Page"}),(0,c.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"User Information"}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Email:"})," ",t.email]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"User ID:"})," ",t.id]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Current Credits:"})," ",l]})]}),(0,c.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test Controls"}),(0,c.jsxs)("div",{className:"space-x-4",children:[(0,c.jsx)("button",{onClick:function(){return v(t.id)},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Refresh Credits"}),(0,c.jsx)("button",{onClick:j,className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:"Add 50 Credits (Test)"}),(0,c.jsx)("button",{onClick:y,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Deduct 5 Credits (Test)"})]})]}),(0,c.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Test Results"}),(0,c.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:0===x.length?(0,c.jsx)("p",{className:"text-gray-500",children:"No tests run yet. Click the buttons above to test!"}):x.map((function(e,t){return(0,c.jsxs)("div",{className:"border-l-4 border-gray-300 pl-4 py-2",children:[(0,c.jsx)("div",{className:"font-semibold",children:e.title}),(0,c.jsx)("div",{className:"text-sm text-gray-600",children:e.message}),(0,c.jsx)("div",{className:"text-xs text-gray-400",children:e.timestamp})]},t)}))})]}),(0,c.jsxs)("div",{className:"mt-6 bg-yellow-50 p-4 rounded-lg",children:[(0,c.jsx)("h3",{className:"font-semibold mb-2",children:"Testing Instructions:"}),(0,c.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[(0,c.jsx)("li",{children:"Make sure you've executed the SQL schema in Supabase"}),(0,c.jsx)("li",{children:"Ensure your environment variables are set (SUPABASE_URL, etc.)"}),(0,c.jsx)("li",{children:'Click "Add 50 Credits" to test credit addition'}),(0,c.jsx)("li",{children:'Click "Deduct 5 Credits" to test credit deduction'}),(0,c.jsx)("li",{children:"Check the test results below"}),(0,c.jsx)("li",{children:"Verify in Supabase that transactions are being recorded"})]})]})]}):(0,c.jsxs)("div",{className:"p-8",children:[(0,c.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Credits System Test"}),(0,c.jsx)("p",{children:"Please log in to test the credits system."})]})}},7663:function(e){!function(){var t={229:function(e){var t,r,n=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:s}catch(e){t=s}try{r="function"===typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var a,o=[],u=!1,l=-1;function d(){u&&a&&(u=!1,a.length?o=a.concat(o):l=-1,o.length&&h())}function h(){if(!u){var e=c(d);u=!0;for(var t=o.length;t;){for(a=o,o=[];++l<t;)a&&a[l].run();l=-1,t=o.length}a=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.push(new f(e,t)),1!==o.length||u||c(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var i=r[e]={exports:{}},c=!0;try{t[e](i,i.exports,n),c=!1}finally{c&&delete r[e]}return i.exports}n.ab="//";var s=n(229);e.exports=s}()}},function(e){e.O(0,[524,774,888,179],(function(){return t=7057,e(e.s=t);var t}));var t=e.O();_N_E=t}]);